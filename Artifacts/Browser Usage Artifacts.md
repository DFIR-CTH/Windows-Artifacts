## üåê Browser Usage Artifacts

### History

| **Field** | **Details** |
|-----------|-------------|
| **Purpose** | Track websites visited by users including URLs, page titles, visit timestamps, and visit counts. Reconstruct user web browsing activity for investigations. |
| **Key Characteristics** | ‚Ä¢ Stored in SQLite databases (Chrome, Firefox, Edge)<br>‚Ä¢ Contains URLs, page titles, visit count, last visit time, typed count<br>‚Ä¢ Tracks navigation through links, typed URLs, bookmarks<br>‚Ä¢ May persist deleted entries in unallocated database space<br>‚Ä¢ Chrome/Edge: Includes keyword search history<br>‚Ä¢ Firefox: Consolidated in places.sqlite with bookmarks<br>‚Ä¢ Different retention periods per browser |
| **Locations** | **Google Chrome:**<br>`C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\History`<br>SQLite database<br><br>**Mozilla Firefox:**<br>`C:\Users\<username>\AppData\Roaming\Mozilla\Firefox\Profiles\[profile name]\places.sqlite`<br>SQLite database<br><br>**Microsoft Edge (Chromium):**<br>`C:\Users\<username>\AppData\Local\Microsoft\Edge\User Data\Default\History`<br>SQLite database<br><br>**Internet Explorer/Edge Legacy:**<br>`C:\Users\<username>\AppData\Local\Microsoft\Windows\WebCache\WebCacheV01.dat`<br>ESE database |
| **Parsing Steps** | 1. Identify browser(s) used on system<br>2. Navigate to browser profile directories<br>3. **For Chrome/Edge (Chromium):**<br>   - Copy "History" SQLite database<br>   - Query "urls" table: id, url, title, visit_count, last_visit_time<br>   - Query "visits" table: visit_time, from_visit, transition type<br>   - Decode timestamps (WebKit format: microseconds since Jan 1, 1601)<br>4. **For Firefox:**<br>   - Copy "places.sqlite" database<br>   - Query "moz_places" table: url, title, visit_count, last_visit_date<br>   - Query "moz_historyvisits" table: visit_date, visit_type<br>   - Decode timestamps (Unix epoch microseconds)<br>5. **For Edge Legacy/IE:**<br>   - Extract WebCacheV01.dat (ESE database)<br>   - Use ESE database viewer to query history containers<br>6. Analyze visit patterns:<br>   - Typed URLs vs. clicked links<br>   - Visit frequency (repeated access)<br>   - Timeline reconstruction<br>7. Carve unallocated space for deleted entries<br>8. Correlate with cookies, cache, downloads |
| **Tools** | ‚Ä¢ **DB Browser for SQLite** - Manual database inspection<br>‚Ä¢ **Hindsight** - Chrome/Chromium history parser<br>‚Ä¢ **Browser History Examiner** - Multi-browser support<br>‚Ä¢ **MZHistoryView** (NirSoft) - Firefox history viewer<br>‚Ä¢ **Autopsy** - Automated browser artifact extraction<br>‚Ä¢ **Magnet AXIOM** - Comprehensive browser forensics<br>‚Ä¢ **X-Ways Forensics** - SQLite parsing and carving<br>‚Ä¢ **ESEDatabaseView** (NirSoft) - Edge Legacy/IE parsing |
| **Additional Info** | ‚Ä¢ Chrome/Edge use WebKit timestamp format (convert with formula)<br>‚Ä¢ Firefox uses Unix epoch microseconds (different conversion)<br>‚Ä¢ Private/Incognito browsing does NOT write to history database<br>‚Ä¢ InPrivate/Incognito leaves traces in memory, cache, DNS<br>‚Ä¢ History cleared by user may leave recoverable data in SQLite free pages<br>‚Ä¢ Transition types reveal how page accessed (typed, link, reload, etc.)<br>‚Ä¢ Visit count indicates user interest or repeated suspicious activity<br>‚Ä¢ Cross-reference with TypedURLs registry for IE/Edge confirmation<br>‚Ä¢ Critical for investigating phishing, malware downloads, insider data theft |

---

### Cookies

| **Field** | **Details** |
|-----------|-------------|
| **Purpose** | Store session data, authentication tokens, user preferences, and tracking information set by websites. Prove website access even after history deletion and reveal login sessions. |
| **Key Characteristics** | ‚Ä¢ Stored in SQLite databases (Chrome, Firefox, Edge)<br>‚Ä¢ Contains: cookie name, value, domain/host, path, creation time, last accessed time, expiration<br>‚Ä¢ Persistent cookies survive browser closure<br>‚Ä¢ Session cookies deleted when browser closes<br>‚Ä¢ May persist longer than history (different deletion policies)<br>‚Ä¢ Can reveal sites not in history (deleted or private browsing artifacts) |
| **Locations** | **Google Chrome:**<br>`C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Network\Cookies`<br>SQLite database<br><br>**Mozilla Firefox:**<br>`C:\Users\<username>\AppData\Roaming\Mozilla\Firefox\Profiles\[profile name]\cookies.sqlite`<br>SQLite database<br><br>**Microsoft Edge (Chromium):**<br>`C:\Users\<username>\AppData\Local\Microsoft\Edge\User Data\Default\Network\Cookies`<br>SQLite database<br><br>**Internet Explorer/Edge Legacy:**<br>`C:\Users\<username>\AppData\Local\Microsoft\Windows\INetCookies\`<br>Individual text files |
| **Parsing Steps** | 1. Identify browser(s) in use on system<br>2. Navigate to browser profile cookie locations<br>3. **For Chrome/Edge (Chromium):**<br>   - Copy "Cookies" SQLite database from Network folder<br>   - Query "cookies" table fields:<br>     ‚Ä¢ host_key (domain)<br>     ‚Ä¢ name (cookie identifier)<br>     ‚Ä¢ value (data stored)<br>     ‚Ä¢ creation_utc, last_access_utc, expires_utc<br>     ‚Ä¢ is_secure, is_httponly flags<br>   - Decode timestamps (WebKit format)<br>4. **For Firefox:**<br>   - Copy "cookies.sqlite" database<br>   - Query "moz_cookies" table:<br>     ‚Ä¢ host, name, value<br>     ‚Ä¢ creationTime, lastAccessed, expiry<br>   - Decode timestamps (Unix epoch microseconds)<br>5. **For IE/Edge Legacy:**<br>   - Extract individual cookie text files<br>   - Parse cookie format (name=value pairs)<br>6. Analyze for investigative value:<br>   - Authentication tokens (session cookies)<br>   - Login usernames embedded in cookie values<br>   - Sites accessed not in history<br>   - Timeline: creation vs. last access dates<br>7. Decrypt encrypted cookie values (if needed, browser-specific)<br>8. Correlate cookies with history for comprehensive timeline |
| **Tools** | ‚Ä¢ **MZCookiesView** (NirSoft) - Firefox cookie viewer<br>‚Ä¢ **DB Browser for SQLite** - Manual inspection<br>‚Ä¢ **Browser History Examiner** - Multi-browser cookies<br>‚Ä¢ **Hindsight** - Chrome cookie parsing<br>‚Ä¢ **Autopsy** - Automated cookie extraction<br>‚Ä¢ **Magnet AXIOM** - Cookie decryption and analysis<br>‚Ä¢ **IECookiesView** (NirSoft) - IE/Edge Legacy cookies<br>‚Ä¢ **X-Ways Forensics** - SQLite parsing |
| **Additional Info** | ‚Ä¢ Cookies persist longer than history (useful when history cleared)<br>‚Ä¢ Session cookies may survive in memory even after browser closes<br>‚Ä¢ Authentication tokens in cookies can enable session hijacking<br>‚Ä¢ HttpOnly flag prevents JavaScript access (security measure)<br>‚Ä¢ Secure flag ensures HTTPS-only transmission<br>‚Ä¢ Cookie values may contain usernames, email addresses, tracking IDs<br>‚Ä¢ Third-party cookies reveal ad networks, analytics, tracking<br>‚Ä¢ Chrome/Edge encrypt cookie values (require decryption key from user profile)<br>‚Ä¢ Useful for proving website access when history unavailable<br>‚Ä¢ Critical for session replay attacks, account compromise investigations |

---

### Cache

| **Field** | **Details** |
|-----------|-------------|
| **Purpose** | Store temporary copies of web content (images, scripts, stylesheets, HTML) to speed up page loading. Recover website content, images, and scripts even after history deletion. |
| **Key Characteristics** | ‚Ä¢ Stores files with original or hashed filenames<br>‚Ä¢ Contains HTTP headers, URLs, file content, access timestamps<br>‚Ä¢ Chrome/Edge: Cache stored in indexed files (f_###### format)<br>‚Ä¢ Firefox: Cache2 folder with hashed filenames<br>‚Ä¢ May retain data after browsing history cleared<br>‚Ä¢ Recoverable artifacts include images, JavaScript, HTML, CSS |
| **Locations** | **Google Chrome:**<br>`C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Cache\Cache_Data\`<br>Indexed files (f_######)<br><br>**Mozilla Firefox:**<br>`C:\Users\<username>\AppData\Local\Mozilla\Firefox\Profiles\[profile name]\cache2\entries\`<br>Hashed filenames<br><br>**Microsoft Edge (Chromium):**<br>`C:\Users\<username>\AppData\Local\Microsoft\Edge\User Data\Default\Cache\Cache_Data\`<br>Indexed files (f_######)<br><br>**Internet Explorer/Edge Legacy:**<br>`C:\Users\<username>\AppData\Local\Microsoft\Windows\INetCache\`<br>Organized by subdirectories |
| **Parsing Steps** | 1. Identify browser(s) used on system<br>2. Navigate to cache directories<br>3. **For Chrome/Edge (Chromium):**<br>   - Locate Cache_Data folder<br>   - Parse index file to map cache entries<br>   - Extract f_###### files<br>   - Use cache parser to extract:<br>     ‚Ä¢ Original URL<br>     ‚Ä¢ HTTP headers<br>     ‚Ä¢ File content (binary data)<br>     ‚Ä¢ Access timestamps<br>4. **For Firefox:**<br>   - Locate cache2/entries folder<br>   - Parse hashed filenames<br>   - Extract cache entry headers and content<br>   - Decode timestamps and URLs from metadata<br>5. **For IE/Edge Legacy:**<br>   - Navigate INetCache subfolders<br>   - Extract cached files (retain original extensions)<br>6. Analyze recovered content:<br>   - Images, videos (prove site access)<br>   - JavaScript files (malicious script analysis)<br>   - HTML snapshots (page content reconstruction)<br>7. Correlate cache URLs with history timeline<br>8. Carve unallocated space for deleted cache entries |
| **Tools** | ‚Ä¢ **NirSoft ChromeCacheView** - Chrome cache viewer and extractor<br>‚Ä¢ **MozillaCacheView** (NirSoft) - Firefox cache parsing<br>‚Ä¢ **IECacheView** (NirSoft) - IE/Edge Legacy cache<br>‚Ä¢ **Browser History Examiner** - Multi-browser cache analysis<br>‚Ä¢ **Magnet AXIOM** - Automated cache recovery<br>‚Ä¢ **Autopsy** - Cache extraction and timeline integration<br>‚Ä¢ **X-Ways Forensics** - Cache file carving<br>‚Ä¢ **Hindsight** - Chrome cache parsing with metadata |
| **Additional Info** | ‚Ä¢ Cache survives browsing history deletion (separate data store)<br>‚Ä¢ Private/Incognito mode may write temporary cache (RAM disk)<br>‚Ä¢ Cache size limits cause automatic purging of oldest entries<br>‚Ä¢ Images in cache prove visual content viewed (critical in CSAM cases)<br>‚Ä¢ JavaScript in cache may reveal malware delivery mechanisms<br>‚Ä¢ HTTP headers in cache entries show server responses, cookies<br>‚Ä¢ Chrome/Edge cache index maps URLs to f_###### files<br>‚Ä¢ Firefox uses content-addressable storage (hashed filenames)<br>‚Ä¢ Cache carving in unallocated space can recover deleted entries<br>‚Ä¢ Critical for reconstructing user activity, malware analysis, OSINT |

---

### Session Restore

| **Field** | **Details** |
|-----------|-------------|
| **Purpose** | Save and restore open tabs, window state, and form data when browser crashes or closes. Recover user's active browsing session including URLs, scroll positions, form inputs. |
| **Key Characteristics** | ‚Ä¢ Stores open tabs, window positions, form data, scroll positions<br>‚Ä¢ JSON or JSONLZ4 format (Firefox)<br>‚Ä¢ Updated periodically during browsing session<br>‚Ä¢ Chrome: Stores Current Session, Current Tabs, Last Session, Last Tabs<br>‚Ä¢ Firefox: sessionstore.jsonlz4 with compressed backup files<br>‚Ä¢ Recovers closed tabs and crashed sessions |
| **Locations** | **Google Chrome:**<br>`C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Current Session`<br>`C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Current Tabs`<br>`C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Last Session`<br>`C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Last Tabs`<br><br>**Mozilla Firefox:**<br>`C:\Users\<username>\AppData\Roaming\Mozilla\Firefox\Profiles\[profile name]\sessionstore.jsonlz4`<br>`C:\Users\<username>\AppData\Roaming\Mozilla\Firefox\Profiles\[profile name]\sessionstore-backups\`<br>(previous.jsonlz4, recovery.jsonlz4, upgrade.jsonlz4)<br><br>**Microsoft Edge (Chromium):**<br>`C:\Users\<username>\AppData\Local\Microsoft\Edge\User Data\Default\Current Session`<br>`C:\Users\<username>\AppData\Local\Microsoft\Edge\User Data\Default\Last Session` |
| **Parsing Steps** | 1. Identify browser and navigate to session storage directory<br>2. **For Chrome/Edge:**<br>   - Extract "Current Session" and "Last Session" files<br>   - Parse binary SNSS format using forensic tool<br>   - Extract:<br>     ‚Ä¢ Open tab URLs<br>     ‚Ä¢ Tab navigation history<br>     ‚Ä¢ Window positions<br>     ‚Ä¢ Form data (if stored)<br>3. **For Firefox:**<br>   - Extract sessionstore.jsonlz4<br>   - Decompress LZ4 format to JSON<br>   - Parse JSON structure:<br>     ‚Ä¢ windows array (multiple windows)<br>     ‚Ä¢ tabs array (URLs, titles, scroll positions)<br>     ‚Ä¢ formdata (text entered in forms)<br>     ‚Ä¢ cookies (session-specific)<br>   - Check sessionstore-backups for previous sessions<br>4. Extract URLs from active tabs at time of capture<br>5. Recover form data (usernames, search queries, text inputs)<br>6. Identify tabs user intended to return to (active session state)<br>7. Correlate with history and cookies for comprehensive timeline |
| **Tools** | ‚Ä¢ **SessionHistoryParser** - Chrome/Edge session file parser<br>‚Ä¢ **Firefox Session Restore Parser** - Decompress and parse JSONLZ4<br>‚Ä¢ **Browser History Examiner** - Multi-browser session extraction<br>‚Ä¢ **Magnet AXIOM** - Automated session restore recovery<br>‚Ä¢ **Autopsy** - Session file parsing<br>‚Ä¢ **Hindsight** - Chrome session analysis<br>‚Ä¢ **Manual** - Python scripts to decompress Firefox JSONLZ4 |
| **Additional Info** | ‚Ä¢ Session files updated every 15 seconds (Firefox) or per navigation (Chrome)<br>‚Ä¢ "Current Session" = active session at time of acquisition<br>‚Ä¢ "Last Session" = previous browser session before current<br>‚Ä¢ Firefox sessionstore-backups: previous.jsonlz4 (backup), recovery.jsonlz4 (crash recovery)<br>‚Ä¢ Form data may include usernames, passwords (if not saved), search queries<br>‚Ä¢ Critical for recovering active suspicious browsing at time of seizure<br>‚Ä¢ May reveal tabs user intended to hide (closed before shutdown)<br>‚Ä¢ Session cookies in Firefox session files prove authentication state<br>‚Ä¢ Useful in ongoing investigation: capture before user closes tabs<br>‚Ä¢ Private/Incognito browsing may not write session files (depends on crash) |

---

### TypedURLs

| **Field** | **Details** |
|-----------|-------------|
| **Purpose** | Track URLs manually typed into Internet Explorer/Edge address bar. Prove intentional navigation to specific websites by recording user-typed web addresses. |
| **Key Characteristics** | ‚Ä¢ Stores last 25 manually typed URLs<br>‚Ä¢ Values named url1, url2, ..., url25 (url1 = most recent)<br>‚Ä¢ Names rotate when new URL added (url1 becomes url2, new entry becomes url1)<br>‚Ä¢ Does NOT capture auto-completed URLs unless previously visited<br>‚Ä¢ URLs accessed via Favorites, Home Page NOT recorded<br>‚Ä¢ Deleted when user clears IE browsing history<br>‚Ä¢ IE6: Updates only when browser properly closed; IE8+: Real-time updates |
| **Locations** | **Internet Explorer/Edge Legacy:**<br>`NTUSER.DAT\Software\Microsoft\Internet Explorer\TypedURLs`<br><br>**TypedURLsTime (Timestamps):**<br>`NTUSER.DAT\Software\Microsoft\Internet Explorer\TypedURLsTime`<br>(Stores UTC timestamps for each typed URL)<br><br>**Registry Hive Path:**<br>`C:\Users\<username>\NTUSER.DAT` |
| **Parsing Steps** | 1. Extract NTUSER.DAT registry hive using forensic tool<br>2. Navigate to TypedURLs key<br>3. Extract values url1 through url25:<br>   - url1 = most recently typed URL<br>   - url25 = oldest typed URL<br>4. Navigate to TypedURLsTime key (parallel structure)<br>5. Extract corresponding timestamp values (1 through 25)<br>6. Decode timestamps from 64-bit FILETIME (UTC format)<br>7. Pair each URL with its timestamp for timeline<br>8. Analyze typed URLs for:<br>   - Suspicious domains (C2 servers, phishing sites)<br>   - Internal IP addresses (lateral movement)<br>   - Webmail, cloud storage (data exfiltration)<br>   - Manually typed intent vs. accidental click<br>9. Correlate with browser history for comprehensive picture<br>10. Check if TypedURLs key deleted (anti-forensics indicator) |
| **Tools** | ‚Ä¢ **Registry Explorer** (Eric Zimmerman) - Manual inspection<br>‚Ä¢ **RECmd** (Eric Zimmerman) - Batch extraction with timestamps<br>‚Ä¢ **RegRipper** - TypedURLs plugin<br>‚Ä¢ **ArtiFast** - Automated TypedURLs parsing<br>‚Ä¢ **Autopsy** - Registry analysis module<br>‚Ä¢ **Magnet AXIOM** - Correlation with browser history |
| **Additional Info** | ‚Ä¢ **Internet Explorer/Edge Legacy specific** (Chrome/Firefox do not use this artifact)<br>‚Ä¢ Max 25 entries before oldest purged<br>‚Ä¢ Typed URLs indicate deliberate navigation (stronger evidence than clicked links)<br>‚Ä¢ TypedURLsTime provides precise UTC timestamps (critical for timeline)<br>‚Ä¢ Cleared by IE "Clear History" feature (Evidence of concealment)<br>‚Ä¢ Also cleared via Control Panel ‚Üí "Clear List" feature<br>‚Ä¢ Auto-complete entries NOT recorded unless site previously visited<br>‚Ä¢ URLs selected from drop-down history list ARE recorded<br>‚Ä¢ Useful for proving knowledge and intent (user typed malicious URL)<br>‚Ä¢ Critical in insider threat, data exfiltration, and attribution investigations |

---
